<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="theme-color" content="#0f172a" />
  <title>SpendCraft ‚Äî Premium Dashboard</title>

  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/1055/1055627.png">

  <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

  <!-- Libs -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <!-- CSS -->
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <div class="app-container" id="appRoot">
    <!-- Sidebar -->
    <aside>
      <div class="brand">
        <div
          style="width:32px;height:32px;background:linear-gradient(135deg,var(--primary),#818cf8);border-radius:8px;">
        </div>
        SpendCraft
      </div>

      <nav class="nav-menu">
        <div class="nav-item active">Dashboard</div>
        <div class="nav-item">Analytics</div>
        <div class="nav-item">Transactions</div>
        <div class="nav-item">Settings</div>
      </nav>

      <div style="margin-top:auto">
        <button id="addTxBtn" class="btn" style="width:100%">+ New Transaction</button>
      </div>
    </aside>

    <!-- Header -->
    <header>
      <div class="page-title">
        <h1>Dashboard</h1>
        <p id="clock">Welcome back</p>
      </div>

      <div class="controls">
        <button id="exportPdfBtn" class="btn primary small" title="Download PDF Report">Download Report</button>
        <button id="backupBtn" class="btn ghost small" title="Backup Data">Backup</button>
        <button id="settingsBtn" class="btn ghost small" title="Settings">‚öôÔ∏è Settings</button>
        <button id="themeBtn" class="btn ghost small" title="Toggle Theme">üåì</button>
      </div>
    </header>

    <!-- Main Content -->
    <main id="dashboardMain">
      <!-- Row 1: Key Metrics -->
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-label">Total Balance</div>
          <div class="stat-val" id="totalBalance">‚Çπ0</div>
          <div class="stat-trend trend-up">Net Cashflow</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Monthly Income</div>
          <div class="stat-val" id="totalIncome" style="color:var(--accent-success)">‚Çπ0</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Monthly Expense</div>
          <div class="stat-val" id="totalExpense" style="color:var(--accent-danger)">‚Çπ0</div>
          <div class="stat-trend" id="budgetStatus">
            <span id="pctUsed">0%</span> of Budget
          </div>
        </div>
      </div>

      <!-- Row 2: Charts -->
      <div class="chart-container">
        <div class="chart-header">
          <div class="chart-title">Cash Flow & Spend Trend</div>
        </div>
        <canvas id="mainChart"></canvas>
      </div>

      <div class="chart-container">
        <div class="chart-header">
          <div class="chart-title">Spending by Category</div>
        </div>
        <canvas id="doughnutChart"></canvas>
      </div>

      <!-- Row 3: Calendar View -->
      <div class="calendar-section">
        <div class="chart-header">
          <div class="chart-title">Calendar View</div>
          <div class="calendar-controls">
            <button class="btn ghost small" id="prevMonth">‚Üê</button>
            <span id="currentMonth" style="margin: 0 16px; font-weight: 600;">January 2026</span>
            <button class="btn ghost small" id="nextMonth">‚Üí</button>
          </div>
        </div>
        <div id="calendarGrid" class="calendar-grid">
          <!-- JS populates this -->
        </div>
      </div>

      <!-- Row 4: Recent Activity -->
      <div class="activity-feed" style="grid-column: 1 / -1;">
        <div class="chart-header">
          <div class="chart-title">Transactions</div>
          <div class="controls">
            <select id="filterPeriod" class="form-control small">
              <option value="all">All Time</option>
              <option value="15" selected>Last 15 Days</option>
              <option value="30">Last 30 Days</option>
            </select>
          </div>
        </div>
        <div id="txList" class="tx-list">
          <!-- JS populates this -->
        </div>
      </div>
    </main>
  </div>

  <!-- Add Transaction Modal -->
  <div id="modalOverlay" class="modal-overlay">
    <div class="modal">
      <div class="chart-header">
        <div class="chart-title">Add Transaction</div>
        <button id="closeModal" class="btn ghost small">‚úï</button>
      </div>

      <form id="txForm" onsubmit="return false;">
        <div class="form-group">
          <label>Description</label>
          <input id="desc" type="text" class="form-control" placeholder="Netflix, Salary, etc." required />
        </div>

        <div class="flex gap-2">
          <div class="form-group" style="flex:1">
            <label>Amount (Negative for expense)</label>
            <input id="amount" type="number" step="0.01" class="form-control" placeholder="-500" required />
          </div>
          <div class="form-group" style="flex:1">
            <label>Category</label>
            <select id="category" class="form-control">
              <option>Food</option>
              <option>Transport</option>
              <option>Shopping</option>
              <option>Entertainment</option>
              <option>Bills</option>
              <option>Income</option>
              <option>Other</option>
            </select>
          </div>
        </div>

        <div class="flex gap-2">
          <div class="form-group" style="flex:1">
            <label>Date</label>
            <input id="date" type="date" class="form-control" />
          </div>
        </div>

        <div class="form-group">
          <button id="addBtnSubmit" class="btn" style="width:100%">Save Transaction</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Settings Modal -->
  <div id="settingsOverlay" class="modal-overlay">
    <div class="modal">
      <div class="chart-header">
        <div class="chart-title">Settings</div>
        <button id="closeSettings" class="btn ghost small">‚úï</button>
      </div>

      <div class="form-group">
        <label>Monthly Budget (‚Çπ)</label>
        <input id="budgetInput" type="number" class="form-control" placeholder="50000" />
      </div>

      <div class="form-group">
        <label>Auto-cleanup transactions older than 15 days</label>
        <label class="toggle-switch">
          <input type="checkbox" id="autoCleanup" checked />
          <span class="toggle-slider"></span>
        </label>
      </div>

      <div class="form-group">
        <button id="saveBudget" class="btn" style="width:100%">Save Settings</button>
      </div>
    </div>
  </div>

  <!-- Edit Transaction Modal -->
  <div id="editModalOverlay" class="modal-overlay">
    <div class="modal">
      <div class="chart-header">
        <div class="chart-title">Edit Transaction</div>
        <button id="closeEditModal" class="btn ghost small">‚úï</button>
      </div>

      <form id="editTxForm" onsubmit="return false;">
        <input type="hidden" id="editTxId" />

        <div class="form-group">
          <label>Description</label>
          <input id="editDesc" type="text" class="form-control" placeholder="Netflix, Salary, etc." required />
        </div>

        <div class="flex gap-2">
          <div class="form-group" style="flex:1">
            <label>Amount (Negative for expense)</label>
            <input id="editAmount" type="number" step="0.01" class="form-control" placeholder="-500" required />
          </div>
          <div class="form-group" style="flex:1">
            <label>Category</label>
            <select id="editCategory" class="form-control">
              <option>Food</option>
              <option>Transport</option>
              <option>Shopping</option>
              <option>Entertainment</option>
              <option>Bills</option>
              <option>Income</option>
              <option>Other</option>
            </select>
          </div>
        </div>

        <div class="flex gap-2">
          <div class="form-group" style="flex:1">
            <label>Date</label>
            <input id="editDate" type="date" class="form-control" />
          </div>
        </div>

        <div class="form-group">
          <button id="updateBtnSubmit" class="btn" style="width:100%">Update Transaction</button>
        </div>
      </form>
    </div>
  </div>

  <div id="toastRoot" style="position:fixed;bottom:20px;right:20px;z-index:9999"></div>

  <!-- Your JS file -->
  <script type="module" src="script.js"></script>

  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('./sw.js')
          .then(req => console.log('SW Registered'))
          .catch(err => console.log('SW Error', err));
      });
    }
  </script>
</body>

</html>